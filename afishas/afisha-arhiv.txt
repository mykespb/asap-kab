Работа с архивами событий АП
==================================

2020-11-17 2020-11-26

Источники
----------------------------------

- мои архивы с 1998 (м.б. есть раньше?)
- дополнения от Д.П.Соколова (есть с 1996, м.б раньше на сайтах)
- книги А. и М. Левитанов "От костра к микрофону" и др.
- архивы КП "Восток" (взять с сайта)
- сайты с архивами, webarchive.com
- прочие книги
- сайты В.Вихорева, А.Городницкого, др.
- генезисы Энди Иванова 
- сайты bards.ru, bard.ru, ...

Идеи, форматы, программы, обработка
----------------------------------

форматы:
- неформатированный текст
- то же, ворд, разных версий
- полуформатированный текст, как  у меня в ранних версиях бардафиши
- база данных или её дамп в sqlite3
- tsv, средние версии моей бардафиши
- текст в книге или в сообщении эл. почты или на сайте (м.б. даже в обсуждении)

кодировки и представления:
- cp866
- cp1251
- лексикон
- unicode, utf8
- koi8-r

- json, tsv, ...

вариант работы:
сделать подверсию моего сайта бардафиши для работы с архивными данными,
с настройкой на определенный год,
и приглашение к работе с ними архивистов (А.Левитан, кто ещё может перечитать книгу и вбить в базу старые события по аналогии с новыми)

там же: выделение событий разного типа и уровня,
в т.ч. фестивалей,
и отнесение к ним подсобытий (концертов, мастерских и т.п.),

доп. атрибуты для архивных данных:
- кто добавил/ редактировал информацию о событии?
- состялось ли событие (да, отмена, перенос, замена, прочее)?
- показывать ли событие в афише всем?

доп. обработка записей о событиях: 
- переформатирование длинных многострочных записей,
с неправильными символами
- исправление слов капслоком :)
а) поиск таких слов,
б) автозамена по всей базе,
- исправление типичных опечаток,

сбор стат. информации об исходниках, обработке, результатах,
особенно: сколько всего событий, авторов, мест, какие,
потом это можно будет использовать для получения списков организаций, фестивалей, площадок, клубов и т.п.

вопрос: насколько подробными могут/ должны быть описания событий?
комментарии, ссылки на источники информации, 
ссылки на результаты событя (видео, отзывы текстом, фото, пр.)
в явно виде локально, в сетях,

обозначение событий:
локальный номер,
код uuid(4),
инфа, включающая дату+время+место (кодами или явно) (+ м.б. и уник. код);
uuid (guid) записывать так, чтобы его можно было одним  щелчком мыши выделить),

нужно не переусложнить работу и записанную информацию,
важно, как её будут использовать
теор - если правильно структурировать, то полезно сохранять всю найденную информацию, 
она поможет в дальнейшем делать производные работы,
но нужно определять доступы (типы, права, пользователи и их группы,
хотя бы по-линуксовски: автор (хозяин, создатель инфы (= порции информации); группа автора или иная; прочие пользователи).

Обработка
--------------------

1. 2020-11-17

обработка бард-афиши 1998-2003 годов, архивист: М.Колодин
infile  = './1998-2003u.tab'
outfile = './out-1998-2003u.tab'
кодировка utf8

программа proc1a.py
работает

на входе 1825 строк с описаниями событий и заголовками - реальный файл бардафиши тех лет,
на выходе 1159 событий (и верхняя строка - заголовки)

нормально

2. 2020-11-17

обработка данных 2013 года, архивист: М.Колодин
infile  = './ap2013.tabs'
outfile = './out-ap2013.tab'
кодировка utf8

программа proc1a.py
работает

перформатированный таб-файл
добавлены поля про status, shown

3. 2020-11-17

обработка данных 2004-2014 годов, архивист: М.Колодин

пакетная обработка 4 файлов
ap.2004-2010.txt
ap-2010-2013.txt
ap-2013endu.txt
ap2014u.txt
обработчик
do3a.sh

выход: 
out-ap.2004-2010.tab
out-ap-2010-2013.tab
out-ap-2013endu.tab
out-ap2014u.tab

готово

4. 2020-11-17 2020-11-19

обработка готовой БД в sqlite3, актуальной, с 2014
добавление кодов uuid(4) и года
соответствует текущему состоянию сайта бард-афиши 
http://www.bard-afisha.spb.ru 
архивист, ведущий: М.Колодин

вход: ap.db
выход: apx.db
запуск: do4a.sh
кодировка: utf8

работает

5. сведение к единой таблице sqlite3

добавление к полученной на шаге 4 базе всех tab-файлов

вход: 
out-1998-2003u.tab
out-ap.2004-2010.tab
out-ap-2010-2013.tab
out-ap-2013endu.tab
out-ap2013.tab
out-ap2014u.tab
выход: apx.db
запуск: do5a.sh

это готовый набор данных для выдачи пользователя-человекам и программам

работает

6. получение удобочитаемого дампа базы данных и tab-файла

вход: apx.db
выход: apx.txt
запуск: do6a.sh
кодировка: utf8

работает

на сегодня 4456 записей о событиях в СПб+ЛО

7. выкладывание всего на общедоступные места в Сети, github, пр.

вот что пока с бардафишей 
https://docs.google.com/spreadsheets/d/1rrNiKQh4b0exVEA9YnEA7jCN5X-guRBldRtfS93ZyQg/edit?usp=sharing

-- мы здесь --

8. доработка - корректировка БД

напр., отмечание отменённых событий как cancel, 
удаление дублирующихся строк в БД (напр., попали из разных источников),
и т.п.

9. дополнение массива данных из других источников

...

10. документирование

сбор и обработка существующей документации, 
появляющейся, разработка новой

2020-11-24 
сделана диаграмма сущностей-связей по событиям, 1 подход, надо развить
2 подход - 2020-11-25

2020-11-26
выложен пример необходимости чистки БД на примере 19 Бродячих собак

